@{
    Layout = null;
}


<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>联系人</title>
    <link href="~/Content/css/OA.css" rel="stylesheet" />
    <link href="/Scripts/assets/data-tables/demo_table.css" rel="stylesheet" />
    <link href="~/Scripts/assets/data-tables/DT_bootstrap.css" rel="stylesheet" />
    @*<link href="~/Scripts/assets/timepicker/jquery-ui-timepicker-addon.css" rel="stylesheet" />*@
    <link href="~/Scripts/assets/jquery-ui/jquery-ui.min.css" rel="stylesheet" />
    <script type="text/javascript" src="~/Scripts/jquery-1.7.1.js"></script>
    <script type="text/javascript" src="~/Scripts/assets/jquery-ui/jquery-ui.min.js"></script>
    <script type="text/javascript" src="~/Scripts/assets/timepicker/jquery-ui-timepicker-addon.js"></script>
    <script type="text/javascript" src="~/Scripts/assets/timepicker/jquery-ui-timepicker-zh-CN.js"></script>

    <script type="text/javascript" src="~/Scripts/js/jquery.idTabs.min.js"></script>

    <script type="text/javascript" src="~/Scripts/assets/data-tables/jquery.datatables.min.js"></script>
    <script type="text/javascript" src="~/Scripts/assets/data-tables/DT_bootstrap.js"></script>
    <script type="text/javascript" src="~/Scripts/assets/data-tables/PLE_DT_bootstrap.js"></script>
    <script type="text/javascript" src="~/Scripts/js/PageNotBack.js"></script>

    <link href="~/Scripts/assets/zTree/css/zTreeStyle/zTreeStyle.css" rel="stylesheet" />
    <script src="~/Scripts/assets/zTree/js/jquery.ztree.core.js"></script>
    <script src="~/Scripts/assets/zTree/js/jquery.ztree.excheck.js"></script>
    <script src="~/Scripts/assets/zTree/js/jquery.ztree.exedit.js"></script>

    <script type="text/javascript" src="~/Scripts/js/select-ui.min.js"></script>


    @*    <link href="~/Scripts/layer/skin/layer.css" rel="stylesheet" />
    <link href="~/Scripts/layer/skin/seaning/style.css" rel="stylesheet" />*@

    <link href="~/Scripts/layer/skin/layer.css" rel="stylesheet" />
    <link href="/Scripts/layer/skin/seaning/style.css" rel="stylesheet" />
    <script src="~/Scripts/layer/layer.js"></script>
    <script type="text/javascript">
        layer.config({
            skin: 'layer-ext-seaning',
            offset: ['100px', '33%'],
            title: '提示',
            moveOut: true,
            closeBtn: false,
            extend: '/skin/seaning/style.css'
        });

    </script>
    <style>
        .forminfo li label {
            width: 100px;
            margin-top: 5px;
        }

        .seachform li label {
            width: 75px;
        }

        .addfilebtn {
            width: 40px;
            height: 22px;
            line-height: 22px;
            display: inline-block;
            margin-top: 6px;
            color: rgb(255, 255, 255);
            background: transparent url("/Images/images/btnbg1.png") repeat-x scroll 0% 0%;
            font-size: 15px;
            font-weight: bold;
            border-radius: 3px;
            cursor: pointer;
            text-align: center;
        }

        .black_overlay {
            display: none;
            position: absolute;
            top: 0%;
            left: 0%;
            width: 100%;
            height: 100%;
            background-color: black;
            z-index: 1001;
            -moz-opacity: 0.8;
            opacity: .80;
            filter: alpha(opacity=80);
        }

        .white_content {
            display: none;
            position: absolute;
            top: 10%;
            left: 10%;
            width: 630px;
            height: 270px;
            background-color: white;
            z-index: 1002;
            overflow: auto;
        }

        .btn_ico_a_delete {
            margin-left: -10px;
        }
    </style>

    <script type="text/javascript">
        $(document).ready(function () {
            //alert(readCookie("RoleName"));
            if (readCookie("RoleName").indexOf("党工委书记") != -1 || readCookie("RoleName").indexOf("办事处主任") != -1 || readCookie("RoleName").indexOf("人大工委主任") != -1 || readCookie("RoleName").indexOf("党工委秘书") != -1 || readCookie("RoleName").indexOf("党政办副主任") != -1) {
                document.getElementById("ZY_radio").style.display = "";
                document.getElementById("ZY_span").style.display = "";
                document.getElementById("TJ_radio").style.display = "";
                document.getElementById("TJ_span").style.display = "";
            } else if (readCookie("RoleName").indexOf("副书记") != -1 || readCookie("RoleName").indexOf("政法委员") != -1 || readCookie("RoleName").indexOf("纪工委书记") != -1 || readCookie("RoleName").indexOf("组织委员") != -1 || readCookie("RoleName").indexOf("宣传委员") != -1 || readCookie("RoleName").indexOf("武装部长") != -1 || readCookie("RoleName").indexOf("人大工委副主任") != -1 || readCookie("RoleName").indexOf("副主任（经济发展）") != -1 || readCookie("RoleName").indexOf("副主任（社会事务）") != -1 || readCookie("RoleName").indexOf("副主任（房屋拆迁）") != -1 || readCookie("RoleName").indexOf("副主任（城市建设）") != -1 || readCookie("RoleName").indexOf("总工会主席") != -1) {
                document.getElementById("ZY_radio").style.display = "";
                document.getElementById("ZY_span").style.display = "";
            }
            if (readCookie("RoleName").indexOf("秘书") == -1) {
                document.getElementById("GG").style.display = "none";
                document.getElementById("GG2").style.display = "none";
            }

            $("#ADDRESSID").change(function () {
                var id = $("#ADDRESSID").val();
                if (id != "") {
                    document.getElementById("MEETINGADDRESS").style.display = "none";
                } else {
                    document.getElementById("MEETINGADDRESS").style.display = "";
                }

            })
        });

        function readCookie(name) {
            var cookieValue = "";
            var search = name + "=";
            if (document.cookie.length > 0) {
                offset = document.cookie.indexOf(search);
                if (offset != -1) {
                    offset += search.length;
                    end = document.cookie.indexOf(";", offset);
                    if (end == -1)
                        end = document.cookie.length;
                    cookieValue = unescape(document.cookie.substring(offset, end))
                }
            }
            return cookieValue;
        }

    </script>

    <script type="text/javascript">
        var oTable = null;
        $(document).ready(function () {
            var setting = {
                callback: {
                    onClick: function (event, treeId, treeNode) {
                        $.ajax({
                            url: "/Contacts/GetCountactsByDateUserID?ID=" + treeNode.value + "&NAME=" + treeNode.name + "&Random=" + Math.random(),
                            type: "get",
                            success: function (returnData) {
                                if (returnData.str_Content != "" && returnData.str_Content != undefined) {
                                    layer.tips(returnData.str_Content.replace("$$", "<br>").replace("$$", "<br>").replace("$$", "<br>").replace("$$", "<br>"), $("#" + treeNode.tId + "_span"), {
                                        tips: [4, '#3595CC'],
                                        time: 20000
                                    });
                                }

                            },
                            error: function (mes) {
                                layer.alert('操作失败!', {
                                    icon: 0,
                                    skin: 'layer-ext-seaning'
                                });
                            }
                        });


                        var UnitID = treeNode.value;
                        var isUser = treeNode.unitId;
                        var smsNumber = treeNode.value;
                        $("#UnitID")[0].value = UnitID;


                    },

                }
            };



            var MyGroup = {
                callback: {
                    onClick: function (event, treeId, treeNode) {
                        $.ajax({
                            url: "/Contacts/GetCountactsByDateUserID?ID=" + treeNode.value + "&NAME=" + treeNode.name + "&Random=" + Math.random(),
                            type: "get",
                            success: function (returnData) {
                                if (returnData.str_Content != "" && returnData.str_Content != undefined) {
                                    layer.tips(returnData.str_Content.replace("$$", "<br>").replace("$$", "<br>").replace("$$", "<br>").replace("$$", "<br>"), $("#" + treeNode.tId + "_span"), {
                                        tips: [4, '#3595CC'],
                                        time: 20000
                                    });
                                }

                            },
                            error: function (mes) {
                                layer.alert('操作失败!', {
                                    icon: 0,
                                    skin: 'layer-ext-seaning'
                                });
                            }
                        });

                        var UnitID = treeNode.value;
                        //var isUser = treeNode.unitId;
                        var parentid = treeNode.value;
                        var parentidpid = treeNode.unitId;
                        // alert(parentid);
                        $("#ParentIDPid").val(parentidpid);
                        $("#ParentID").val(parentid);
                        // $("#UnitID")[0].value = UnitID;
                    },
                }
            };


            $.ajax({
                type: 'GET',
                dataType: 'json',
                url: '/UserManagement/GetUserManageTree?random=' + Math.random(),
                success: function (data) {
                    if (data != null && data != "") {
                        unitIDValue = '@ViewData["UnitID"]';
                        var zNodes = data;
                        $.fn.zTree.init($("#tree"), setting, zNodes);
                        var treeObj = $.fn.zTree.getZTreeObj("tree");
                        var node = treeObj.getNodeByParam("value", unitIDValue, null);
                        treeObj.selectNode(node);
                        treeObj.expandNode(node, true);
                    }
                }

            });


            $.ajax({
                type: 'GET',
                dataType: 'json',
                url: '/Contacts/GetCameraTree?random=' + Math.random(),
                success: function (data) {
                    if (data != null && data != "") {
                        unitIDValue = '@ViewData["UnitID"]';
                        var zNodes = data;
                        $.fn.zTree.init($("#MyGroup"), MyGroup, zNodes);
                        var treeObj = $.fn.zTree.getZTreeObj("MyGroup");
                        var node = treeObj.getNodeByParam("value", unitIDValue, null);
                        treeObj.selectNode(node);
                        treeObj.expandAll(false);
                        treeObj.expandNode(node, true);
                    }
                }
            });
        });

        var setting = {
            check: {
                enable: true
            },
            view: {
                dblClickExpand: false
            },
            data: {
                simpleData: {
                    enable: true
                }
            },
            callback: {//该事件在节点被单击后触发
                onCheck: function (e, treeId, zNodes2) {
                    var zTree = $.fn.zTree.getZTreeObj("chkboxTree");
                    nodes = zTree.getCheckedNodes(true);
                    //定义用户组变量
                    var childrenobj = "";
                    var phone = "";
                    for (var i = 0, l = nodes.length; i < l; i++) {
                        if (nodes[i].type != "组织") {
                            childrenobj += nodes[i].value + ",";
                            phone += nodes[i].smsNumber + ",";
                        }
                    }
                    if (childrenobj.length > 0)
                        childrenobj = childrenobj.substring(0, childrenobj.length - 1);
                    $("#SelectUserIds").val(childrenobj);
                    $("#phones").val(phone);

                    //定义用户号码变量
                    var userNames = "";
                    for (var i = 0, l = nodes.length; i < l; i++) {
                        if (nodes[i].type != "组织") {
                            userNames += nodes[i].name + ",";
                        }
                    }

                    if (userNames.length > 0)
                        userNames = userNames.substring(0, userNames.length - 1);

                    $("#SelectUserNames").val(userNames);
                },
                beforeClick: function (treeId, zNodes2) {
                    var zTree = $.fn.zTree.getZTreeObj("chkboxTree");
                    zTree.checkNode(zNodes2, !zNodes2.checked, null, true);
                    return false;
                }
            },
        };

        var TJRY = {
            check: {
                enable: true
            },
            view: {
                dblClickExpand: false
            },
            data: {
                simpleData: {
                    enable: true
                }
            },
            callback: {//该事件在节点被单击后触发
                onCheck: function (e, treeId, zNodes2) {
                    var zTree = $.fn.zTree.getZTreeObj("RYchkboxTree");
                    nodes = zTree.getCheckedNodes(true);
                    //定义用户组变量
                    var childrenobj = "";
                    for (var i = 0, l = nodes.length; i < l; i++) {
                        if (nodes[i].type != "组织") {
                            childrenobj += nodes[i].value + ",";
                        }
                    }
                    if (childrenobj.length > 0)
                        childrenobj = childrenobj.substring(0, childrenobj.length - 1);
                    $("#RY_userids").val(childrenobj);
                },
                beforeClick: function (treeId, zNodes2) {
                    var zTree = $.fn.zTree.getZTreeObj("RYchkboxTree");
                    zTree.checkNode(zNodes2, !zNodes2.checked, null, true);
                    return false;
                }
            },
        };
        var Auditors = {
            check: {

                enable: true,
                chkStyle: "radio",
                radioType: "all"

            },

            view: {
                dblClickExpand: false
            },
            data: {
                simpleData: {
                    enable: true
                }
            },
            callback: {//该事件在节点被单击后触发
                onCheck: function (e, treeId, zNodes2) {
                    var zTree = $.fn.zTree.getZTreeObj("CheckTree");
                    nodes = zTree.getCheckedNodes(true);
                    //定义用户组变量
                    var childrenobj = "";
                    for (var i = 0, l = nodes.length; i < l; i++) {
                        if (nodes[i].type != "组织") {
                            childrenobj = nodes[i].value + ",";
                        }
                    }
                    if (childrenobj.length > 0)
                        childrenobj = childrenobj.substring(0, childrenobj.length - 1);
                    $("#LEAVEAUDITUSER").val(childrenobj);

                    //定义用户号码变量
                    var userNames = "";
                    for (var i = 0, l = nodes.length; i < l; i++) {
                        if (nodes[i].type != "组织") {
                            userNames = nodes[i].name + ",";
                        }
                    }

                    if (userNames.length > 0)
                        userNames = userNames.substring(0, userNames.length - 1);

                    $("#LeaveReviewerName").val(userNames);
                },
                beforeClick: function (treeId, zNodes2) {
                    var zTree = $.fn.zTree.getZTreeObj("CheckTree");
                    zTree.checkNode(zNodes2, !zNodes2.checked, null, true);
                    return false;
                }
            },
        };


        function showMenu() {
            var cityObj = $("#SelectUserNames");
            var cityOffset = $("#SelectUserNames").offset();
            var divWidth = $("#SelectUserNames").width();

            //加载用户结构树
            $.ajax({
                type: 'GET',
                dataType: 'json',
                url: '/Contacts/GetCameraTrees?random=' + Math.random(),
                success: function (data) {
                    if (data != null && data != "") {
                        var zNodes = data;
                        $.fn.zTree.init($("#chkboxTree"), setting, zNodes);
                        var treeObj = $.fn.zTree.getZTreeObj("chkboxTree");
                        treeObj.expandAll(false);

                    }
                }
            });

            $("#menuContent").css({ left: cityOffset.left + "px", top: cityOffset.top + cityObj.outerHeight() + "px", width: 290 }).slideDown("fast");
            $("body").bind("mousedown", onBodyDown);
        }

        function showMenuCheck() {
            var cityObj = $("#LeaveReviewerName");
            var cityOffset = $("#LeaveReviewerName").offset();
            var divWidth = $("#LeaveReviewerName").width();

            //加载审核人员结构树
            $.ajax({
                type: 'GET',
                dataType: 'json',
                url: '/Contacts/GetCameraTrees?random=' + Math.random(),
                success: function (data) {
                    if (data != null && data != "") {
                        var zNodes = data;
                        $.fn.zTree.init($("#CheckTree"), Auditors, zNodes);
                        var treeObj = $.fn.zTree.getZTreeObj("CheckTree");
                        treeObj.expandAll(false);

                    }
                }
            });

            $("#menuCheck").css({ left: cityOffset.left + "px", top: cityOffset.top + cityObj.outerHeight() + "px", width: divWidth * 1.03 }).slideDown("fast");
            $("body").bind("mousedown", onBodyDownCheck);
        }



        //弹出隐藏层
        function ShowDiv(show_div, bg_div) {
            document.getElementById(show_div).style.display = 'block';
            document.getElementById(bg_div).style.display = 'block';
            var bgdiv = document.getElementById(bg_div);
            bgdiv.style.width = document.body.scrollWidth;
            $("#" + bg_div).height($(document).height());
            //加载添加人员结构树
            $.ajax({
                type: 'GET',
                dataType: 'json',
                url: '/Meeting/GetUserManageTree?random=' + Math.random(),
                success: function (data) {
                    if (data != null && data != "") {
                        var zNodes = data;
                        $.fn.zTree.init($("#RYchkboxTree"), TJRY, zNodes);
                        var treeObj = $.fn.zTree.getZTreeObj("RYchkboxTree");
                        treeObj.expandAll(false);
                    }
                }
            });
        };


    </script>



    <script type="text/javascript">
        function getQueryString(name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
            var r = window.location.search.substr(1).match(reg);
            if (r != null)
                return unescape(r[2]);
            return null;
        }
        //后台回调js函数
        function AddCallBack(flag) {
            if (flag == 11) {
                layer.alert("操作成功!", {
                    icon: 1,
                    skin: 'layer-ext-seaning'
                }, function (index) {
                    layer.close(index);
                    location.href = "/Contacts/Index";
                });
            }
            if (flag == 22) {
                layer.alert("操作失败!", {
                    icon: 0,
                    skin: 'layer-ext-seaning'
                }, function (index) {
                    layer.close(index);
                    location.href = "/Contacts/Index";
                });
            }
            if (flag == 12) {
                layer.alert("操作成功!", {
                    icon: 1,
                    skin: 'layer-ext-seaning'
                }, function (index) {
                    layer.close(index);
                    location.href = "/Contacts/Index";
                });
            }
            if (flag == 13) {
                layer.alert("操作成功!", {
                    icon: 1,
                    skin: 'layer-ext-seaning'
                }, function (index) {
                    layer.close(index);
                    location.href = "/Contacts/Index";
                });
            }
            if (flag == 1) {
                layer.alert("操作成功!", {
                    icon: 1,
                    skin: 'layer-ext-seaning'
                }, function (index) {
                    layer.close(index);
                    location.href = "/Contacts/Index";
                });
            }
            if (flag == 2) {
                layer.alert("操作失败!", {
                    icon: 0,
                    skin: 'layer-ext-seaning'
                }, function (index) {
                    layer.close(index);
                    location.href = "/Contacts/Index";
                });
            }
            if (flag == "smssend") {
                layer.alert("操作成功!", {
                    icon: 1,
                    skin: 'layer-ext-seaning'
                }, function (index) {
                    layer.close(index);
                    location.href = "/Contacts/Index";
                });
            } else if (flag == "smsaudit") {
                layer.alert("操作成功,已提交秘书审核!", {
                    icon: 1,
                    skin: 'layer-ext-seaning'
                }, function (index) {
                    layer.close(index);
                    location.href = "/Contacts/Index";
                });
            }
        }
        $(function () {
            $("#ADDRESSID").change(function () {
                var id = $("#ADDRESSID").val();
                if (id != "TJLSDZ") {
                    $("#ADDRESSIDName").val($("#ADDRESSID option:selected").text())
                    document.getElementById("MEETINGADDRESS").style.display = "none";
                    document.getElementById("HYSYYQK").style.display = "";
                    document.getElementById("MEETINGADDRESS").value = "";
                } else {
                    document.getElementById("MEETINGADDRESS").style.display = "";
                    document.getElementById("HYSYYQK").style.display = "none";
                    document.getElementById("MEETINGADDRESS").value = "";
                }
                if (id == "") {
                    document.getElementById("MEETINGADDRESS").style.display = "none";
                    document.getElementById("HYSYYQK").style.display = "none";
                    document.getElementById("MEETINGADDRESS").value = "";
                }

            })
        });

        $(document).ready(function () {
            document.getElementById('grcheckbox').checked = true;
            document.getElementById('kscheckbox').checked = true;
            $("input[name='radio']").click(function () {
                var id = $(this).attr("value");
                //  alert(id);
                if (id == "是") {
                    document.getElementById("SendMessages").value = id;
                } else {
                    document.getElementById("SendMessages").value = id;
                }
            });
            //$("#STARTINGTIME").datepicker();
            $("#FINISHTIME").datetimepicker();
            $("#STIME").datetimepicker();
            $("#ETIME").datetimepicker();



        });


    </script>

    <script type="text/javascript">
        function redio_onclick(id) {
            if (id == "id_Notice") {//公告
                document.getElementById("hide_1").style.display = 'none';
                document.getElementById("id_Notice").style.display = 'block';
                document.getElementById("id_Meeting").style.display = 'none';
                document.getElementById("id_Task").style.display = 'none';
                document.getElementById("id_File").style.display = 'none';
                document.getElementById("id_Message").style.display = 'none';
                document.getElementById("hide_2").style.display = 'block';
                document.getElementById("id_email").style.display = 'none';
                document.getElementById("form1").action = "/Announcement/Commit";
                //document.getElementById("SelectUserIds").value = "";
                //document.getElementById("SelectUserNames").value = "";
                document.getElementById("ALLTYPE").value = "2";
                //alert(document.getElementById("form1").action);
                document.getElementById("SGSR").style.display = 'none';
                $("#manualphones").val("");
            }
            else if (id == "id_Meeting") {//会议

                document.getElementById("hide_1").style.display = 'block';
                document.getElementById("id_Notice").style.display = 'none';
                document.getElementById("id_Meeting").style.display = 'block';
                document.getElementById("id_Task").style.display = 'none';
                document.getElementById("id_File").style.display = 'none';
                document.getElementById("id_Message").style.display = 'none';
                document.getElementById("id_email").style.display = 'none';
                document.getElementById("hide_2").style.display = 'block';
                // alert(document.getElementById("form1").action);
                // document.getElementById("form1").action = "111";
                document.getElementById("form1").action = "/Meeting/Add";
                //document.getElementById("SelectUserIds").value = "";
                //document.getElementById("SelectUserNames").value = "";
                document.getElementById("ALLTYPE").value = "1";
                //alert(document.getElementById("form1").action);
                document.getElementById("SGSR").style.display = 'block';
                document.getElementById("defaulttemplate").innerHTML = "您有一个【XXXX会议】于【XXXX-XX-XX XX:XX】在【XXX会议室】举行，请准时参加  【发送人：XXX】";
                $("#manualphones").val("");
            }
            else if (id == "id_Task") {//任务
                document.getElementById("hide_1").style.display = 'block';
                document.getElementById("id_Notice").style.display = 'none';
                document.getElementById("id_Meeting").style.display = 'none';
                document.getElementById("id_Task").style.display = 'block';
                document.getElementById("id_File").style.display = 'none';
                document.getElementById("id_Message").style.display = 'none';
                document.getElementById("id_email").style.display = 'none';
                document.getElementById("hide_2").style.display = 'block';
                document.getElementById("form1").action = "/Task/Add";
                //document.getElementById("SelectUserIds").value = "";
                //document.getElementById("SelectUserNames").value = "";
                document.getElementById("ALLTYPE").value = "3";
                // alert(document.getElementById("form1").action);
                document.getElementById("SGSR").style.display = 'none';
                document.getElementById("defaulttemplate").innerHTML = "您有一个任务【XXXX】已发送至您的OA系统，完成期限是【XXXX-XX-XX XX:XX】，请注意查看  【发送人：XXX】";
                $("#manualphones").val("");
            }
            else if (id == "id_File") {//文件
                document.getElementById("hide_1").style.display = 'block';
                document.getElementById("id_Notice").style.display = 'none';
                document.getElementById("id_Meeting").style.display = 'none';
                document.getElementById("id_Task").style.display = 'none';
                document.getElementById("id_File").style.display = 'block';
                document.getElementById("id_Message").style.display = 'none';
                document.getElementById("id_email").style.display = 'none';
                document.getElementById("hide_2").style.display = 'block';
                document.getElementById("form1").action = "/File/Commit";
                //document.getElementById("SelectUserIds").value = "";
                //document.getElementById("SelectUserNames").value = "";
                document.getElementById("ALLTYPE").value = "4";
                //alert(document.getElementById("form1").action);
                document.getElementById("SGSR").style.display = 'none';
                document.getElementById("defaulttemplate").innerHTML = "您有一个文件【XXXX】【XXXX】已发送至您的OA系统，请注意查收  【发送人：XXX】";
                $("#manualphones").val("");
            }
            else if (id == "id_Message") {//短信
                document.getElementById("hide_1").style.display = 'block';
                document.getElementById("id_Notice").style.display = 'none';
                document.getElementById("id_Meeting").style.display = 'none';
                document.getElementById("id_Task").style.display = 'none';
                document.getElementById("id_File").style.display = 'none';
                document.getElementById("id_Message").style.display = 'block';
                document.getElementById("hide_2").style.display = 'none';
                document.getElementById("id_email").style.display = 'none';
                //document.getElementById("SelectUserIds").value = "";
                //document.getElementById("SelectUserNames").value = "";
                document.getElementById("ALLTYPE").value = "5";
                document.getElementById("form1").action = "/Contacts/SendMessage";
                document.getElementById("SGSR").style.display = 'block';
                $("#manualphones").val("");
            } else if (id == "id_email") {//邮件
                document.getElementById("hide_1").style.display = 'block';
                document.getElementById("id_Notice").style.display = 'none';
                document.getElementById("id_Meeting").style.display = 'none';
                document.getElementById("id_Task").style.display = 'none';
                document.getElementById("id_File").style.display = 'none';
                document.getElementById("id_Message").style.display = 'none';
                document.getElementById("id_email").style.display = 'block';
                document.getElementById("hide_2").style.display = 'block';
                //document.getElementById("SelectUserIds").value = "";
                //document.getElementById("SelectUserNames").value = "";
                document.getElementById("ALLTYPE").value = "6";
                document.getElementById("form1").action = "/Email/Commit";
                document.getElementById("SGSR").style.display = 'none';
                document.getElementById("defaulttemplate").innerHTML = "您有一条邮件【XXXX】已发送至您的OA系统，请注意查收  【发送人：XXX】";
                $("#manualphones").val("");
            }

        }
        function addfz_click() {
            ShowDiv('MyDiv1', 'fade');
        }
        function button_FZ() {
            var FZMC = $("#FZMC").val();
            if (FZMC == "" || FZMC == null) {
                layer.alert('请添加分组名称！', {
                    icon: 0,
                    skin: 'layer-ext-seaning'
                });
                return false;
            }
            $.ajax({
                type: "POST",
                url: "/Contacts/AddFZ",
                data: {
                    FZMC: FZMC
                },
                cache: false,
                success: function (data) {
                    if (data == 1) {
                        layer.alert('添加分组成功!', { icon: 1, skin: 'layer-ext-seaning' }, function (index) {
                            layer.close(index);
                            location.href = "/Contacts/Index";
                        });
                    }
                },
                error: function () {
                    layer.alert('网络异常，请重试！', {
                        icon: 0,
                        skin: 'layer-ext-seaning'
                    });
                }
            });
        }

        //添加人员按钮
        function addbtn_click() {
            var Parentid = $("#ParentID").val();
            var ParentIDPid = $("#ParentIDPid").val();
            if (Parentid != "" && ParentIDPid == "") {
                ShowDiv('MyDiv2', 'fade');
            } else {
                layer.alert('请先选择分组再添加人员！', {
                    icon: 0,
                    skin: 'layer-ext-seaning'
                });
                return false;
            }
        }
        //添加人员方法
        function button_RY() {
            var RY_userids = $("#RY_userids").val();
            var Parentid = $("#ParentID").val();
            if (RY_userids == "" || RY_userids == null) {
                layer.alert('请选择人员！', {
                    icon: 0,
                    skin: 'layer-ext-seaning'
                });
                return false;
            }
            $.ajax({
                type: "POST",
                url: "/Contacts/AddUser",
                data: {
                    Parentid: Parentid, RY_userids: RY_userids
                },
                cache: false,
                success: function (data) {
                    if (data == 1) {
                        layer.alert('添加人员成功!', { icon: 1, skin: 'layer-ext-seaning' }, function (index) {
                            layer.close(index);
                            location.href = "/Contacts/Index";
                        });
                    }
                },
                error: function () {
                    layer.alert('网络异常，请重试！', {
                        icon: 0,
                        skin: 'layer-ext-seaning'
                    });
                }
            });

        }


        //删除按钮
        function delbtn_click() {
            var Parentid = $("#ParentID").val();
            var ParentIDPid = $("#ParentIDPid").val();
            //alert(Parentid + "---" + ParentIDPid);
            if (Parentid != "" && ParentIDPid == "") {
                layer.confirm('是否确认删除整个分组?', {
                    btn: ['是', '否'],
                    icon: 4,
                    //按钮
                }, function () {
                    $.ajax({
                        type: "POST",
                        url: "/Contacts/DeleteGroup",
                        data: {
                            Parentid: Parentid
                        },
                        cache: false,
                        success: function (data) {
                            if (data == 1) {
                                layer.alert('删除分组成功!', { icon: 1, skin: 'layer-ext-seaning' }, function (index) {
                                    layer.close(index);
                                    location.href = "/Contacts/Index";
                                });
                            }
                        },
                        error: function () {
                            layer.alert('网络异常，请重试！', {
                                icon: 0,
                                skin: 'layer-ext-seaning'
                            });
                        }
                    });


                }, function () {
                    layer.close();
                });
            } else if (Parentid != "" && ParentIDPid != "") {
                layer.confirm('是否确认删除人员?', {
                    btn: ['是', '否'],
                    icon: 4,
                    //按钮
                }, function () {
                    $.ajax({
                        type: "POST",
                        url: "/Contacts/DeleteUser",
                        data: {
                            Parentid: Parentid, ParentIDPid: ParentIDPid
                        },
                        cache: false,
                        success: function (data) {
                            if (data == 1) {
                                layer.alert('删除人员成功!', { icon: 1, skin: 'layer-ext-seaning' }, function (index) {
                                    layer.close(index);
                                    location.href = "/Contacts/Index";
                                });
                            }
                        },
                        error: function () {
                            layer.alert('网络异常，请重试！', {
                                icon: 0,
                                skin: 'layer-ext-seaning'
                            });
                        }
                    });
                })
            } else {
                layer.alert('请先选择人员或分组再选择删除！', {
                    icon: 0,
                    skin: 'layer-ext-seaning'
                });
            }
        }
        function DZ_Search() {
            oTable1.fnPageChange('first', true);
            oTable1.fnClearTable(false);
        }
        var oTable1;
        function HocListtablelist() {
            if (oTable1 != null) {
                oTable1.fnSettings().sAjaxSource = "/HocList/HocListTableList";
                oTable1.fnDraw(true);
            } else {
                oTable1 = $('#HocListtableList').dataTable({
                    sAjaxSource: "/HocList/HocListTableList",
                    "bLengthChange": false,
                    fnServerParams: function (aoData) {
                        aoData.push(
                             { "name": "DZSTARTINGTIME", "value": $("#DZSTARTINGTIME").val() },
                               { "name": "DZENDTIME", "value": $("#DZENDTIME").val() },
                               { "name": "MeetingAddresses", "value": $("#MeetingAddresses").val() }
                            );
                    },
                    aoColumns: [
                        { mDataProp: "ADDRESSNAME" },
                        //{ mDataProp: "MEETINGTITLE" },
                        { mDataProp: "STIME" },
                        { mDataProp: "ETIME" },
                        { mDataProp: "USERNAME" },
                    ],
                    aoColumnDefs: [{ sDefaultContent: '', aTargets: ['_all'] }],
                    fnDrawCallback: function (oSettings) {
                        var pagerIndex = oSettings._iDisplayStart / oSettings._iDisplayLength + 1;
                        var $currentPager = $(".dataTables_paginate span a:contains('" + pagerIndex + "')");
                        $currentPager.attr("style", "font-weight :bold;!important");
                    }
                });
            }
        }



        function Hoc_look(show_div, bg_div) {
            var h = $(document).height();
            $("body").height(h);
            document.getElementById(show_div).style.display = 'block';
            document.getElementById(bg_div).style.display = 'block';
            var bgdiv = document.getElementById(bg_div);
            bgdiv.style.width = document.body.scrollWidth;
            $("#" + bg_div).height($("body").height());
            $("#" + show_div).css("top", ($(document).scrollTop() + 130));
            document.getElementById("MeetingAddresses").value = $("#ADDRESSID").val();

            HocListtablelist();

        }

        //关闭弹出层
        function CloseDiv(show_div, bg_div) {
            document.getElementById(show_div).style.display = 'none';
            document.getElementById(bg_div).style.display = 'none';
        };

        function Click_Div(show_div, bg_div) {
            document.getElementById(show_div).style.display = 'none';
            document.getElementById(bg_div).style.display = 'none';
        }



        function onBodyDown(event) {
            if (!(event.target.id == "menuBtn" || event.target.id == "SelectUserNames" || event.target.id == "menuContent" || $(event.target).parents("#menuContent").length > 0)) {
                hideMenu();
            }
        }
        function hideMenu() {
            $("#menuContent").fadeOut("fast");
            $("#menuCheck").fadeOut("fast");
            $("body").unbind("mousedown", onBodyDown);
        }


        function onBodyDownCheck(event) {
            if (!(event.target.id == "menuBtn" || event.target.id == "LeaveReviewerName" || event.target.id == "menuCheck" || $(event.target).parents("#menuCheck").length > 0)) {
                hideMenu();
            }
        }
        //添加文件
        function AddAfterFile(data) {
            $("#AddAfterFile").after("<div style='margin: 20px 0px;'><input name='AddFile" + Math.random(10000, 99999) + "' type='file'  value='' /><a style='color: red;' onclick='DeleteFile(this);'>删除</a></div>");
        }

        //删除文件
        function DeleteFile(obj) {
            $(obj).parent().remove();
        }

        function validate_form(thisform) {
            var alltype = $("#ALLTYPE").val();
            if (alltype == 1) {
                var STIME = $("#STIME").val();
                var ETIME = $("#ETIME").val();
                if (ETIME != null && ETIME != "") {
                    if (STIME > ETIME || STIME == ETIME && ETIME != "" && ETIME != null) {
                        layer.alert('开始时间不能大于结束时间！', {
                            icon: 0,
                            skin: 'layer-ext-seaning'
                        });
                        return false;
                    }
                }
                if ($("#ADDRESSID").val() == "") {
                    layer.alert('请选择或输入临时地址！', {
                        icon: 0,
                        skin: 'layer-ext-seaning'
                    });
                    return false;
                } else if ($("#ADDRESSID").val() == "TJLSDZ") {
                    if ($("#MEETINGADDRESS").val() == "") {
                        layer.alert('请选择或输入临时地址！', {
                            icon: 0,
                            skin: 'layer-ext-seaning'
                        });
                        return false;
                    }
                }

                with (thisform) {
                    if (validate_required(SelectUserIds, "参会人员不能为空!") == false)
                    { SelectUserIds.focus(); return false }
                    if (validate_required(MEETINGTITLE, "会议名称不能为空!") == false)
                    { MEETINGTITLE.focus(); return false }
                    if (validate_required(STIME, "会议开始时间不能为空!") == false)
                    { STIME.focus(); return false }
                    if (validate_required(ETIME, "会议结束时间不能为空!") == false)
                    { ETIME.focus(); return false }
                    if (validate_required(Meeting_CONTENT, "会议内容不能为空!") == false)
                    { Meeting_CONTENT.focus(); return false }
                    if (validate_required(LEAVEAUDITUSER, "审核人员不能为空!") == false)
                    { LEAVEAUDITUSER.focus(); return false }
                    if ($("#radiovalue").val() == "manual" && $("#manualcontent").val() == "") {
                        layer.alert("发送内容不能为空!", {
                            icon: 0,
                            skin: 'layer-ext-seaning'
                        });
                        return false;
                    }

                    else { return true }
                }
            }
            else if (alltype == 2) {
                with (thisform) {
                    if (validate_required(NOTICETITLE, "公告标题不能为空!") == false)
                    { NOTICETITLE.focus(); return false }
                    if (validate_required(NOTICETYPE, "公告类型不能为空!") == false)
                    { NOTICETYPE.focus(); return false }
                    if (validate_required(AUTHOR, "发布人不能为空!") == false)
                    { AUTHOR.focus(); return false }
                    if (validate_required(CONTENT, "公告内容不能为空!") == false)
                    { CONTENT.focus(); return false }
                    else { return true }
                }
            }
            else if (alltype == 3) {
                with (thisform) {
                    if (validate_required(SelectUserIds, "任务人员不能为空!") == false)
                    { SelectUserIds.focus(); return false }
                    if (validate_required(TASKTITLE, "任务名称不能为空!") == false)
                    { TASKTITLE.focus(); return false }
                    if (validate_required(TASKCONTENT, "任务内容不能为空!") == false)
                    { TASKCONTENT.focus(); return false }
                    if ($("#radiovalue").val() == "manual" && $("#manualcontent").val() == "") {
                        layer.alert("发送内容不能为空!", {
                            icon: 0,
                            skin: 'layer-ext-seaning'
                        });
                        return false;
                    }
                    else { return true }
                }
            }
            else if (alltype == 4) {
                //if ($("#SelectUserIds").val() == null) {
                //    layer.alert("文件接收人不能为空!");
                //    return false;
                //}
                with (thisform) {
                    if (validate_required(SelectUserIds, "文件接收人不能为空!") == false)
                    { SelectUserIds.focus(); return false }
                    if (validate_required(FILETITLE, "文件名称不能为空!") == false)
                    { FILETITLE.focus(); return false }
                    //if (validate_required(FILENUMBER, "文件文号不能为空!") == false)
                    //{ FILENUMBER.focus(); return false }
                    if (validate_required(FILECONTENT, "文件内容不能为空!") == false)
                    { FILECONTENT.focus(); return false }
                    if ($("#radiovalue").val() == "manual" && $("#manualcontent").val() == "") {
                        layer.alert("发送内容不能为空!", {
                            icon: 0,
                            skin: 'layer-ext-seaning'
                        });
                        return false;
                    }
                    else { return true }
                }
            } else if (alltype == 5) {
                with (thisform) {
                    if (validate_required(SelectUserIds, "接收人员不能为空!") == false)
                    { SelectUserIds.focus(); return false }
                    if (validate_required(SMS_CONTENT, "消息内容不能为空!") == false)
                    { SMS_CONTENT.focus(); return false }
                    else { return true }
                }
            } else if (alltype == 6) {
                //if ($("#SelectUserIds").val() == null || $("#SelectUserIds").val() == "") {
                //    layer.alert("邮件接收人不能为空!", {
                //        icon: 0,
                //        skin: 'layer-ext-seaning'
                //    });
                //    return false;
                //}
                with (thisform) {
                    if (validate_required(SelectUserIds, "邮件接收人不能为空!") == false)
                    { SelectUserIds.focus(); return false }
                    if (validate_required(EMAILTITLE, "邮件名称不能为空!") == false)
                    { EMAILTITLE.focus(); return false }
                    if ($("#radiovalue").val() == "manual" && $("#manualcontent").val() == "") {
                        layer.alert("发送内容不能为空!", {
                            icon: 0,
                            skin: 'layer-ext-seaning'
                        });
                        return false;
                    }
                }
            }
        }
        function validate_required(field, alerttxt) {
            with (field) {
                if (value == null || value == "") {
                    layer.alert(alerttxt, {
                        icon: 0,
                        skin: 'layer-ext-seaning'
                    });
                    return false
                }
                else { return true }
            }
        }
        function validate_select(fieId, alerttxt) {
            with (fieId) {
                if (value == IndexStr(value)) {
                    layer.alert(alerttxt, {
                        icon: 0,
                        skin: 'layer-ext-seaning'
                    }); return false
                }
                else { return true }
            }
        }

        function grcheck() {
            var grcheckbox = document.getElementById('grcheckbox');
            var kscheckbox = document.getElementById('kscheckbox');
            if (grcheckbox.checked || kscheckbox.checked) {
                document.getElementById('bsccheckbox').checked = false;
                document.getElementById('dgwcheckbox').checked = false;
            }

        }
        function ldcheck() {
            var bsccheckbox = document.getElementById('bsccheckbox');
            var dgwheckbox = document.getElementById('dgwcheckbox');
            if (bsccheckbox.checked || dgwheckbox.checked) {
                document.getElementById('grcheckbox').checked = false;
                document.getElementById('kscheckbox').checked = false;
            }

        }
        function redio_click(id) {
            if (id == "default") {
                $("#manualcontent").val("");
                document.getElementById("manualcontent").style.display = "none";
                document.getElementById("defaulttemplate").style.display = "";
            } else if (id == "manual") {
                document.getElementById("manualcontent").style.display = "";
                document.getElementById("defaulttemplate").style.display = "none";
            }
            $("#radiovalue").val(id);
        }
    </script>
</head>
<body>
    <div class="place">
        <span>位置：</span>
        <ul class="placeul">
            <li>联系人</li>
        </ul>
    </div>
    <div style="width: 20%; float: left; margin: 10px">
        <div class="formtitle">
            <span>联系人</span>
        </div>
        <div>
            <ul id="tree" class="ztree"></ul>
        </div>
        <div style="height: 40%">
            <div class="formtitle">
                <span>我的群组</span>
            </div>
            <div>
                <input id="ParentID" type="text" style="display: none;" />
                <input id="ParentIDPid" type="text" style="display: none;" />
                <input type="button" onclick="addfz_click();" value="新增分组" style="background-color: #4198ca; color: #ffffff; width: 28%; padding: 3px 3px; font-size: 8pt;" />&nbsp;&nbsp;
                <input type="button" onclick="addbtn_click();" value="新增人员" style="background-color: #4198ca; color: #ffffff; width: 28%; padding: 3px 3px; font-size: 8pt;" />&nbsp;&nbsp;
            <input type="button" onclick="delbtn_click();" value="删除" style="background-color: #4198ca; color: #ffffff; width: 28%; padding: 3px 3px; font-size: 8pt;" />

            </div>
            <ul id="MyGroup" class="ztree"></ul>
        </div>
    </div>
    <div style="width: 77%; float: left; border: 1px">
        <div class="formbody">
            <div class="formtitle"><span>基本信息</span></div>
            <ul class="forminfo">
                <li>
                    <label>选择类型<b>*</b></label>
                    <div style="margin-top: 20px">
                        <label style="width: 110px;">
                            <input type="radio" name="id_radio" value="发送消息" onclick="redio_onclick('id_Message')" checked="checked" /><span style="font-size: 13pt; font-weight: bold; color: #0000E3; margin-left: 5px;">发送短消息</span></label>
                        <label style="width: 95px;" id="idemail">
                            <input type="radio" name="id_radio" value="邮件" onclick="redio_onclick('id_email')" /><span style="font-size: 13pt; font-weight: bold; color: #9F35FF; margin-left: 5px;">内部邮件</span></label>
                        <label style="width: 60px;" id="GG2">
                            <input type="radio" name="id_radio" value="文件" onclick="redio_onclick('id_File')" /><span style="font-size: 13pt; font-weight: bold; color: #00E3E3; margin-left: 5px;">文件</span></label>
                        <label style="width: 60px;">
                            <input type="radio" name="id_radio" value="会议" onclick="redio_onclick('id_Meeting')" /><span style="font-size: 13pt; color: #00BB00; font-weight: bold; margin-left: 5px;">会议</span></label>
                        <label style="width: 60px;">
                            <input type="radio" name="id_radio" value="任务" onclick="redio_onclick('id_Task')" /><span style="font-size: 13pt; font-weight: bold; color: #EA7500; margin-left: 5px;">任务</span></label>
                        <label style="width: 60px;" id="GG">
                            <input type="radio" name="id_radio" value="公告" onclick="redio_onclick('id_Notice')" /><span style="font-size: 13pt; font-weight: bold; color: #9F35FF; margin-left: 5px;">公告</span></label>


                    </div>
                </li>
            </ul>
            <form id="form1" method="post" enctype="multipart/form-data" action="/Contacts/SendMessage" onsubmit="return validate_form(this)" target="hidden_frame">
                <div id="hide_1">
                    <ul class="forminfo">
                        <li>
                            <label>人员名单<b>*</b></label>
                            <div class="col-sm-9 col-lg-10 controls" style="margin-left: 100px;">
                                <textarea name="SelectUserNames" id="SelectUserNames" style="height: 64px; width: 700px;" rows="10" cols="10" type="text" class="dfinputs" placeholder="请选择人员" onclick="showMenu();" onfocus="this.blur();"></textarea>
                                @*  <input name="SelectUserNames" id="SelectUserNames" type="text" class="dfinputs" placeholder="请选择人员" onclick="showMenu();" onfocus="this.blur();" />*@

                                <br />
                                <span class="error_FromUserName"></span>
                            </div>
                            <input type="hidden" id="SelectUserIds" name="SelectUserIds" value="" />
                            <input type="hidden" id="phones" name="phones" value="" />
                        </li>
                        <li id="SGSR">
                            <label id="manuallabel">手工输入号码</label><input name="manualphones" id="manualphones" type="text" class="dfinputs" style="width: 700px;" value="" placeholder="每个手机号码之间用“,”逗号隔开" />
                        </li>
                    </ul>

                </div>
                <div id="id_Notice" style="display: none">

                    <ul class="forminfo">
                        <li>
                            <label>公告标题<b>*</b></label>
                            <input name="NOTICETITLE" type="text" class="dfinputs" placeholder="请输入公告标题" />
                        </li>
                        <li>
                            <label>公告类型<b>*</b></label>
                            <input name="NOTICETYPE" type="text" class="dfinputs" placeholder="请输入公告类型" />
                        </li>
                        <li>
                            <label>发 布 人 <b>*</b></label>
                            <input name="AUTHOR" type="text" class="dfinputs" placeholder="请输入发布人" />
                        </li>
                        <li>
                            <label>公告内容<b>*</b></label>
                            <textarea name="CONTENT" class="dfinputs" style="width: 700px; height: 130px;" placeholder="请输入公告内容"></textarea>
                        </li>

                    </ul>
                </div>
                <div id="id_Meeting" style="display: none">
                    <ul class="forminfo">
                        <li>
                            <label>会议名称<b>*</b></label>
                            <input id="MEETINGTITLE" name="MEETINGTITLE" type="text" class="dfinputs" value="" placeholder="请输入会议名称" />
                        </li>
                        <li>
                            <label>会议开始时间<b>*</b></label>
                            <input type="text" id="STIME" readonly="readonly" name="STIME" class="dfinputs" placeholder="请选择会议开始时间" />
                            <label style="text-align: center">至<b>*</b></label>
                            <input type="text" id="ETIME" readonly="readonly" name="ETIME" class="dfinputs" placeholder="请选择会议结束时间" />
                        </li>

                        <li>
                            <label>会议地点<b>*</b></label>
                            @* <input id="ADDRESS" name="ADDRESS" type="text" class="dfinputs" value="" placeholder="请输入会议地点" />*@
                            @Html.DropDownList("ADDRESSID", ViewBag.MeetingAddress as IEnumerable<SelectListItem>, "请点击选择", new { @name = "ADDRESSID", @class = "dfinputs" })
                            <input id="MEETINGADDRESS" name="MEETINGADDRESS" type="text" class="dfinputs" style="display: none" value="" placeholder="请输入会议地址" />
                            <input id="HYSYYQK" name="HYSYYQK" type="button" class="sure" style="display: none; width: 110px;" onclick="Hoc_look('HYSYYQKList', 'fade')" value="会议室预约情况" />
                            <input type="hidden" id="ADDRESSIDName" name="ADDRESSIDName" value="" />
                        </li>
                        <li>
                            <label>会议内容<b>*</b></label>
                            <textarea id="Meeting_CONTENT" name="Meeting_CONTENT" class="dfinputs" style="width: 700px; height: 130px" placeholder="请输入会议内容"></textarea>
                        </li>

                        <li>
                            <label>请假审核人员<b>*</b></label>
                            <div class="col-sm-9 col-lg-10 controls" style="margin-left: 100px;">
                                <input name="LeaveReviewerName" id="LeaveReviewerName" type="text" class="dfinputs" placeholder="请选择请假审核人员" style="width: 300px;" onclick="showMenuCheck();" onfocus="this.blur();" />
                                <br />
                                <span class="error_FromUserName"></span>
                            </div>
                            <input type="hidden" id="LEAVEAUDITUSER" name="LEAVEAUDITUSER" value="" />
                        </li>

                    </ul>
                </div>
                <div id="id_Task" style="display: none">
                    <ul class="forminfo">
                        <li>
                            <label>任务名称<b>*</b></label>
                            <input name="TASKTITLE" id="TASKTITLE" type="text" class="dfinputs" value="" placeholder="请输入任务名称" />
                        </li>


                        <li>
                            <label>完成期限<b>*</b></label>
                            <input type="text"  id="FINISHTIME" readonly="readonly" name="FINISHTIME" value="@DateTime.Now.ToString("yyyy-MM-dd HH:mm")" class="dfinputs" />
                        </li>
                        <li>
                            <label>任务内容<b>*</b></label>
                            <textarea id="TASKCONTENT" name="TASKCONTENT" class="dfinputs" style="width: 700px; height: 130px;" placeholder="请输入任务内容"></textarea>
                        </li>
                        <li>
                            <label style="float: left">重要程度<b>*</b></label>
                            <div style="float: left; margin-top: 10px;">
                                <input type="radio" name="type_LX" value="1" checked="checked" /><span style="margin-left: 5px;">一般</span>
                                <input type="radio" name="type_LX" value="2" id="ZY_radio" style="display: none" /><span id="ZY_span" style="margin-left: 5px; display: none">重要</span>
                                <input type="radio" name="type_LX" value="3" id="TJ_radio" style="display: none" /><span id="TJ_span" style="margin-left: 5px; display: none">特急</span>
                            </div>
                        </li>

                    </ul>
                </div>
                <div id="id_File" style="display: none">
                    <ul class="forminfo">

                        <li>
                            <label>文件名称<b>*</b></label>
                            <input name="FILETITLE" type="text" class="dfinputs" placeholder="请输入文件名称" />
                        </li>
                        <li>
                            <label>文件文号</label>
                            <input name="FILENUMBER" type="text" class="dfinputs" placeholder="请输入文件文号" />
                        </li>
                        <li>
                            <label>文件内容<b>*</b></label>
                            <textarea name="FILECONTENT" class="dfinputs" placeholder="请输入文件内容" style="width: 700px; height: 130px"></textarea>
                        </li>

                        <li>
                            <input type="hidden" name="hidden-fileid" value="0" />
                            <input type="hidden" name="hidden-isedit" value="0" />
                        </li>
                    </ul>
                </div>
                <div id="id_Message">
                    <ul class="forminfo">
                        <li>
                            <label>消息内容<b>*</b></label>
                            <textarea id="SMS_CONTENT" name="SMS_CONTENT" class="dfinputs" style="width: 700px; height: 130px;" placeholder="请输入短信内容"></textarea>
                        </li>
                        <li>
                            <label>发送人身份</label>
                            <label style="width: 50px">
                                <input id="grcheckbox" name="grcheckbox" type="checkbox" class="dcheckbox" style="margin-top: 10px;" value="gr" onclick="grcheck()" /><span>个人</span></label>
                            <label style="width: 80px">
                                <input id="kscheckbox" name="kscheckbox" type="checkbox" class="dcheckbox" style="margin-top: 10px;" value="ks" onclick="grcheck()" /><span>部门科室</span></label>
                            <label style="width: 95px">
                                <input id="bsccheckbox" name="bsccheckbox" type="checkbox" class="dcheckbox" style="margin-top: 10px;" value="bsc" onclick="ldcheck()" /><span>街道办事处</span></label>
                            <label style="width: 95px">
                                <input id="dgwcheckbox" name="dgwcheckbox" type="checkbox" class="dcheckbox" style="margin-top: 10px;" value="dgw" onclick="ldcheck()" /><span>街道党工委</span></label>
                        </li>
                        <li>
                            <label>&nbsp;</label>
                            <input name="" type="submit" class="sure" value="发  送" />
                        </li>
                    </ul>
                </div>
                <div id="id_email" style="display: none">
                    <ul class="forminfo">

                        <li>
                            <label id="ReplayEmailTitle">主题<b>*</b></label>
                            <input name="EMAILTITLE" type="text" class="dfinputs" placeholder="请输入邮件名称" />
                        </li>
                        <li>
                            <label id="ReplayEmailContent">正文</label>
                            <textarea name="EMAILCONTENT" class="dfinputs" placeholder="请输入邮件内容" style="width: 700px; height: 130px"></textarea>
                        </li>
                    </ul>

                </div>

                <div id="hide_2" style="display: none">
                    <ul class="forminfo">
                        <li>
                            <label>上传附件</label>
                            <div id="showfile" style="margin-left: 90px;">
                                <div id="AddAfterFile" class="addfilebtn" onclick="AddAfterFile(AddAfterFile);">添加</div>
                            </div>
                        </li>
                        <li>
                            <label>短信提示</label>
                            <label style="width: 80px">
                                <input id="default" name="radio" type="radio" class="dcheckbox" style="margin-top: 10px;" value="default" checked onclick="redio_click('default')" /><span>默认模板</span></label>
                            <label style="width: 80px">
                                <input id="manual" name="radio" type="radio" class="dcheckbox" style="margin-top: 10px;" value="manual" onclick="redio_click('manual')" /><span>手工输入</span></label>@* <input id="manualcontent" name="manualcontent" type="text" class="dfinputs" style="display: none" placeholder="请输入发送内容" />*@


                        </li>
                        <li id="template_li">
                            <label>&nbsp;</label>
                            <textarea id="manualcontent" name="manualcontent" class="dfinputs" placeholder="请输入模板内容" style="display: none; width: 700px; height: 80px"></textarea>
                            <textarea id="defaulttemplate" name="defaulttemplate" class="dfinputs" readonly="readonly" style="width: 700px; height: 80px; color: #8e8e8e;"></textarea>
                            <input type="hidden" name="radiovalue" id="radiovalue" value="default" />
                        </li>
                        <li>
                            <input type="hidden" id="ALLTYPE" name="ALLTYPE" value="5" />
                            <input type="hidden" id="SendMessages" name="Task_SendMessages" value="2" />
                            <input type="hidden" id="IMPORTANT" name="IMPORTANT" value="1" />
                            <label>&nbsp;</label>
                            <input name="" type="submit" class="sure" value="确  认" />
                        </li>
                    </ul>

                </div>

            </form>
        </div>

    </div>

    <div id="menuContent" class="menuContent" style="display: none; position: absolute; z-index: 99999999;">
        <ul id="chkboxTree" class="ztree" style="margin-top: 0; width: 290px; height: 350px; border: 1px solid #cdcdcd; background-color: rgb(255, 255, 255); color: #393939; overflow-y: scroll;"></ul>
    </div>
    <div id="menuCheck" class="menuCheck" style="display: none; position: absolute; z-index: 99999999;">
        <ul id="CheckTree" class="ztree" style="margin-top: 0; width: 290px; height: 180px; border: 1px solid #cdcdcd; background-color: rgb(255, 255, 255); color: #393939; overflow-y: scroll;"></ul>
    </div>


    <!--弹出层时背景层DIV-->
    <div id="fade" class="black_overlay"></div>
    <div id="MyDiv1" class="white_content">
        <div class="tiptop"><span>添加分组</span><a onclick="Click_Div('MyDiv1','fade')"></a></div>
        <div id="Div_FZ">
            <label style="float: left; margin: 20px">分组名称:<b style="color: red">*</b></label>
            <input name="name" id="FZMC" type="text" class="dfinputs" placeholder="请输入分组名称" />
            <input type="button" id="button_FZ" style="margin-right: 20px; float: right; margin-top: 10px; height: 30px; line-height: 30px; font-size: 16px; background-color: #4198ca; color: #ffffff; width: 10%;" value="添加" onclick="button_FZ();" />
        </div>
    </div>
    <div id="MyDiv2" class="white_content" style="height: 395px;">
        <div class="tiptop"><span>添加人员</span><a onclick="Click_Div('MyDiv2','fade')"></a></div>
        <div id="Div_RY">
            <input type="text" id="RY_userids" name="RY_userids" style="display: none;" value="" />
            <ul id="RYchkboxTree" class="ztree" style="margin-top: 0; width: 610px; height: 300px; margin-left: 5px; border: 1px solid #cdcdcd; background-color: rgb(255, 255, 255); color: #393939; overflow-y: scroll;"></ul>
            <div>
                <input type="button" id="button_RY" style="margin-right: 20px; float: right; margin-top: 10px; height: 30px; line-height: 30px; font-size: 16px; background-color: #4198ca; color: #ffffff; width: 10%;" value="确定" onclick="button_RY();" />

            </div>
        </div>

    </div>
    <div id="HYSYYQKList" class="white_content" style="height: auto; width: 80%;">
        <div class="tiptop"><span>会议室预约情况</span><a onclick="CloseDiv('HYSYYQKList','fade')"></a></div>
        <div style="clear: both; margin-top: 10px; margin-left: 2%;">
            <ul class="seachform">
                <li>
                    <label style="width: 105px;">会议开始时间：</label>
                    <input id="DZSTARTINGTIME" type="text" readonly="readonly" class="dfinputs" data-date-format="yyyy-mm-dd" value="@string.Format("{0:yyyy-MM-dd}", DateTime.Now)" style="width: 130px;height:32px;" />
                    <label style="width: 10px;">至</label><input id="DZENDTIME" type="text" readonly="readonly" class="dfinputs" data-date-format="yyyy-mm-dd" value="@string.Format("{0:yyyy-MM-dd}", DateTime.Now.AddDays(7))" style="width: 130px;height:32px;" />
                </li>
                <li>
                    <label style="width: 90px;">会议地址：</label>
                    @Html.DropDownList("MeetingAddresses", ViewBag.Meetingaddres as IEnumerable<SelectListItem>, new { @class = "dfinputs", @style = "width:130px;height:32px" })
                </li>
                <li>
                    <input name="" type="button" class="sure" onclick="DZ_Search()" value="查询" />
                </li>
            </ul>
        </div>
        <div style="clear: both; margin-top: 10px; width: 95%; margin-left: 2%;" class="tableListDiv">
            <table class="tablelist" id="HocListtableList">
                <thead>
                    <tr>
                        <th>会议地址名称</th>
                        <th>会议开始时间</th>
                        <th>会议结束时间</th>
                        <th>会议创建人</th>
                    </tr>
                </thead>

            </table>
        </div>
        <div style="height: 40px; width: 100%">
            @*  <div class="tipbtn">
                <input type="button" class="sure" onclick="CloseDiv('HYSYYQKList', 'fade')" style="float: right;margin-bottom:10px; margin-right: 20px" value="关闭" />
            </div>*@
        </div>
    </div>
    <iframe name='hidden_frame' id="hidden_frame" style="display: none"></iframe>
</body>
</html>
